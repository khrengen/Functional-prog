;;генерация всех подмножеств данного множества

(defun subsets (lst)
  (if lst
      (let ((head (first lst))                                      ;отделяем голову
            (z (subsets (rest lst))))                               ;запуск рекурсии для хвоста
       (append (mapcar (lambda (y) (cons head y)) z) z))            ;к каждому элементу либо прибавляем  голову
                                                                    ;либо нет, соединяем все в один список
      '(NIL)))                                                      ;выход из рекурсии
